
import java.util.ArrayList;
import java.util.Scanner;

import javax.sound.sampled.SourceDataLine;

public class TP1 {
	static String[][] temasDoJogo = new String[50][50]; // Matriz para armazenar os temas.
	static  int i = 0, j = 1;

	public static void main(String[] args) {

		// Variaveis e constantes:
		int opcaoMenuInicial = 0, opcaoMenuTemas = 0, opcaoMenuPalavras = 0, opcaoTemas = 0, opcaoMenuPalavras1 = 0;
		String opcaoBuscarTemas = null;
		Boolean temaIgual = false;
		Boolean palavraIgual = false;
		String temasTotais = "0";
		String palavrasTotais = "0";

		// Tela inicial:
		Scanner resposta = new Scanner(System.in); // Leitura da resposta do usu�rio.


		do {
			opcaoMenuInicial = Menu(opcaoMenuInicial, resposta); // Funcao do menu.

			// Opcoes do menu
			switch (opcaoMenuInicial) {
				case 1:
					do {
						opcaoMenuTemas = MenuTemas(opcaoMenuTemas, resposta);
						switch (opcaoMenuTemas) {
							case 1:
								String nomeDosTemas = " ";
								temasDoJogo[i][0] = GerenciarTemas(opcaoMenuTemas, resposta, temasDoJogo, nomeDosTemas,
										temasTotais, temaIgual, i);
								i++;
								break;
							case 2:
								// String valorBusca = GerenciarBusca(opcaoBuscarTemas,resposta);
								BuscarTemas(GerenciarBusca(opcaoBuscarTemas, resposta), temasDoJogo, i, j);
								break;
							case 3:
								Boolean validacao = false;
								do {
									System.out.print("|-------- Excluir tema --------|\n");
									System.out.print("| Digite um tema do jogo para  |\n");
									System.out.print("|         ser exluido          |\n");
									System.out.print("|------------------------------|\n");
									nomeDosTemas = " ";
									nomeDosTemas = resposta.next(); // Lembrar de por 0 quando por as palavras.
									validacao = ExcluirTema(nomeDosTemas, temasDoJogo, i);
								}while(!validacao);
								break;
							case 4: 
								System.out.println(" ");
								break;
							default: System.out.println("Opcao invalida. Por favor, escolha uma\n"
									+ "opcaoo de 1 a 4, somente.\n");
						}
					}while (opcaoMenuTemas != 4);

					break;

				case 2:
					do {
						opcaoMenuPalavras1 = Menu2( opcaoMenuPalavras1,resposta);
						switch(opcaoMenuPalavras1) {
							case 1:
								String palavraDosTemas = " ";
								temasDoJogo[0][j] = GerenciarPalavras(opcaoMenuPalavras1, resposta, temasDoJogo, palavraDosTemas, palavrasTotais, palavraIgual, j);
								j++;
								break;
							case 2:
								System.out.println("bbb");
								break;
							case 3:
								System.out.println("ccc");
								break;
							case 4:
								System.out.println("ddd");
								break;
							case 5:
								System.out.println(" ");
								break;
							default: System.out.println("Opcao invalida. Por favor, escolha uma\n"
									+ "opcaoo de 1 a 5, somente.\n");
						}
					}while(opcaoMenuPalavras1 != 5);
					break;

				case 3:
					System.out.println("c\n");
					break;

				case 4:
					System.out.println("Obrigada por jogar!\n"
							+ "--> Maria Abritta :) ");
					break;
				default:
					System.out.println("Opcao invalida. Por favor, escolha uma\n"
							+ "opcaoo de 1 a 4, somente.\n");

			}

		} while (opcaoMenuInicial != 4);

	}

	public static int Menu(int opcaoMenuInicial, Scanner resposta) {
		System.out.print("|------- Jogo da forca! -------|\n");
		System.out.print("|------------------------------|\n");
		System.out.print("| Opcao 1 - Gerenciar Temas    |\n");
		System.out.print("| Opcao 2 - Gerenciar Palavras |\n");
		System.out.print("| Opcao 3 - Jogar              |\n");
		System.out.print("| Opcao 4 - Sair               |\n");
		System.out.print("|------------------------------|\n");
		System.out.print("Digite uma opcao:\n");
		opcaoMenuInicial = resposta.nextInt();
		return opcaoMenuInicial;
	}

	public static int MenuTemas(int opcaoMenuTemas, Scanner resposta) {
		System.out.print("|-- Digite uma opcao --|\n");
		System.out.print("|----------------------|\n");
		System.out.print("|  1 - Cadastrar tema  |\n");
		System.out.print("|  2 - Buscar tema     |\n");
		System.out.print("|  3 - Excluir tema    |\n");
		System.out.print("|  4 - Voltar          |\n");
		System.out.print("|----------------------|\n");
		opcaoMenuTemas = resposta.nextInt();
		return opcaoMenuTemas;
	}

	public static String GerenciarTemas(int opcaoMenuTemas, Scanner resposta, String temasDoJogo[][],
		String nomeDosTemas, String temasTotais, Boolean temaIgual, int i) {
		do {
			System.out.print("|-------- Cadastrar tema ---------|\n");
			System.out.print("|---------------------------------|\n");
			System.out.print("|  Cadastre um tema para o jogo   |\n");
			System.out.print("| OBS: Nao pode ter temas iguais  |\n");
			System.out.print("|---------------------------------|\n");
			nomeDosTemas = " ";
			nomeDosTemas = resposta.next(); // Lembrar de por 0 quando por as palavras.
			temasDoJogo[i][0] = nomeDosTemas;
				if (TemasJaExiste(temasDoJogo, nomeDosTemas, i)) { 
					System.out.println(TemasJaExiste(temasDoJogo, nomeDosTemas, i));
					System.out.println("Esse tema já existe.\n");
			} else {
					if (nomeDosTemas.equals(temasTotais)) {
						temaIgual = true; // Nome repetido
						break;
					} else {
						temasDoJogo[i][0] = nomeDosTemas; // Se nao for repetido irei armazenar
						System.out.println("Na posicao " + i + " foi armazenado " + temasDoJogo[i][0]);
						System.out.println("");
						// i++; //Avancando as posicoes do vetor
						break;
					}
				}
		} while (!temaIgual);
		return temasDoJogo[i][0];
	}

	public static Boolean TemasJaExiste(String temas[][], String pesquisa, int i) {
		for (int c = 0; c < i; c++) { // Vetor que passa por todos os temas cadastrados ate o momento
			if (temas[c][0].equals(pesquisa)) { // Verifico se o tema ja foi registrado antes
				return true;
			}
		}
		return false;
	}

	public static String GerenciarBusca(String opcaoBuscarTemas, Scanner resposta) {
		System.out.print("|---------- Busca -----------|\n");
		System.out.print("|----------------------------|\n");
		System.out.print("|  Qual tema deseja buscar?  |\n");
		System.out.print("|----------------------------|\n");
		opcaoBuscarTemas = resposta.next();
		return opcaoBuscarTemas;
	}

	public static void BuscarTemas(String valorBuscado, String temasDoJogo[][], int i, int j) {
		boolean existe = false;
		for (int a = 0; a < temasDoJogo.length; a++) {
			if (valorBuscado.equals(temasDoJogo[a][0])) {
				existe = true;
			}
		}
		if (existe)
			System.out.println("Esse tema já foi cadastrado.\n");
		else
			System.out.println("Esse tema ainda não foi cadastrado.\n");
	}
	
	public static Boolean ExcluirTema (String temaQueSeraExcluido, String temasDoJogo[][], int i) {
		if (TemasJaExiste(temasDoJogo, temaQueSeraExcluido, i)) { 
			System.out.println("Tema encontrado e será excluido.\n");
			int indice = BuscarPosicaoTema (temasDoJogo, temaQueSeraExcluido);
			temasDoJogo[indice][0] = " ";
			AjustarMatriz();
			return true;
		}else {
			System.out.println("Nao existe esse tema para ser excluido.\n");
			return false;
		}
	}
	
	public static int BuscarPosicaoTema (String temasDoJogo[][], String temaPesquisado) {
		int retorno = 99;
		for(int a = 0; a < temasDoJogo.length; a++) {
			System.out.println(a);
			if(!temasDoJogo[a][0].equals(null) || temasDoJogo[a][0].equals(temaPesquisado)) {
				retorno = a;
				break;
			}
		}
		return retorno;
	}

	public static void AjustarMatriz () {
		String[][] novosTemas = new String[50][50];
        int count = 0;
        for(int i = 0; i < temasDoJogo.length ; i++) {
            if(temasDoJogo[i][0] != null && !temasDoJogo[i][0].isEmpty() && !temasDoJogo[i][0].isBlank()) {
                novosTemas[count] = temasDoJogo[i];
                count++;
            }
        }
        i = count;
        temasDoJogo = novosTemas;
	}
	
	public static int Menu2(int opcaoMenuPalavras, Scanner resposta) {
		System.out.print("|--- Digite uma opcao ----|\n");
		System.out.print("|-------------------------|\n");
		System.out.print("|  1 - Cadastrar palavra  |\n");
		System.out.print("|  2 - Buscar palavra     |\n");
		System.out.print("|  3 - Excluir palavra    |\n");
		System.out.print("|  4 - Listagem           |\n");
		System.out.print("|  5 - Voltar             |\n");
		System.out.print("|-------------------------|\n");
		System.out.print("Digite uma opcao:\n");
		opcaoMenuPalavras = resposta.nextInt();
		return opcaoMenuPalavras;
	}
	
	public static String GerenciarPalavras(int opcaoMenuPalavras, Scanner resposta, String temasDoJogo[][], String palavraDosTemas, String palavrasTotais, Boolean palavraIgual, int j) {
		do {
			System.out.print("|---- -- Cadastrar palavra --------|\n");
			System.out.print("|----------------------------------|\n");
			System.out.print("| Cadastre um palavra para um tema |\n");
			System.out.print("| OBS: Nao pode ter palvras iguais |\n");
			System.out.print("|----------------------------------|\n");
			palavraDosTemas = " ";
			palavraDosTemas = resposta.next();
			temasDoJogo[0][j] = palavraDosTemas;
				if(PalavraJaExiste(temasDoJogo, palavraDosTemas, j)) {
					System.out.println(PalavraJaExiste(temasDoJogo, palavraDosTemas, j));
					System.out.println("Essa palavra já existe\n");
				}else {
					if (palavraDosTemas.equals(palavrasTotais)) {
						palavraIgual = true; // Nome repetido
						break;
					}else {
							temasDoJogo[0][j] = palavraDosTemas; // Se nao for repetido irei armazenar
							System.out.println("Na posicao " + j + " foi armazenado " + temasDoJogo[0][j]);
							System.out.println("");
							break;
						}
				}
		}while(!palavraIgual);
		return temasDoJogo[0][j];
	}
	
	public static Boolean PalavraJaExiste(String temas[][], String pesquisa, int j) {
		for (int d = 0; d < j; d++) { // Vetor que passa por todos os temas cadastrados ate o momento
			if (temas[0][d].equals(pesquisa)) { // Verifico se o tema ja foi registrado antes
				return true;
			}
		}
		return false;
	}
	
	
}
